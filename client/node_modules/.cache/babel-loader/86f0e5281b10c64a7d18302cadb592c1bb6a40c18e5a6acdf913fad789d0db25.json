{"ast":null,"code":"import request from '../../utils/request';\nimport { toast } from \"react-toastify\";\nimport { agencyAction } from '../slices/agencySlice';\n\n// get agencies\nexport function fetchAgency() {\n  return async dispatch => {\n    try {\n      const {\n        data\n      } = await request.get(`api/agencies`);\n      dispatch(agencyAction.setAgencies(data));\n    } catch (error) {\n      toast.error(error.response.data.message);\n    }\n  };\n}\n\n//get agencies count \nexport function getAgenciesCount() {\n  return async dispatch => {\n    try {\n      const {\n        data\n      } = await request.get(`api/agencies/admin/count`);\n      dispatch(agencyAction.setAgencyCount(data));\n    } catch (error) {\n      toast.error(error.response.data.message);\n    }\n  };\n}\n\n//create agency\nexport function createAgency(newAgency) {\n  return async (dispatch, getState) => {\n    try {\n      dispatch(agencyAction.setLoading());\n      await request.post(`api/agencies/admin`, newAgency, {\n        headers: {\n          Authorization: \"Bearer \" + getState().auth.admin.data.token,\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n      dispatch(agencyAction.setIsAgencyCreated()); //put it ro true\n      dispatch(fetchAgency());\n      toast.success(\"agency created successfully\");\n      // after 2 seconsd we set it to false to return to the page\n      setTimeout(() => dispatch(agencyAction.clearIsAgencyCreated()), 2000); //2 second\n    } catch (error) {\n      console.log(error);\n      dispatch(agencyAction.clearLoading());\n      toast.error(error.response.data.message);\n    }\n  };\n}\n\n//update agency picture \nexport function updateAgencyPicture(newImage, AgencyId) {\n  console.log(AgencyId);\n  return async (dispatch, getState) => {\n    try {\n      await request.put(`api/agencies/admin/update-image/${AgencyId}`, newImage, {\n        headers: {\n          Authorization: \"Bearer \" + getState().auth.admin.data.token,\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      });\n      dispatch(fetchAgency());\n      toast.success(\"new agency image uploaded successfully\");\n    } catch (error) {\n      toast.error(error.response.data.message);\n      console.log(error.response);\n    }\n  };\n}\n\n//update agency\nexport function updateAgency(newAgency, AgencytId) {\n  return async (dispatch, getState) => {\n    try {\n      const {\n        data\n      } = await request.put(`api/agencies/admin/${AgencytId}`, newAgency, {\n        headers: {\n          Authorization: \"Bearer \" + getState().auth.admin.data.token\n        }\n      });\n      dispatch(agencyAction.setAgency(data));\n      dispatch(fetchAgency());\n      toast.success(\"agency updated successfully\");\n    } catch (error) {\n      toast.error(error.response.data.message);\n    }\n  };\n}\n\n//delete agency\nexport function deleteAgency(AgencyId) {\n  return async (dispatch, getState) => {\n    try {\n      const {\n        data\n      } = await request.delete(`api/agencies/admin/${AgencyId}`, {\n        headers: {\n          Authorization: \"Bearer \" + getState().auth.admin.data.token\n        }\n      });\n      dispatch(agencyAction.setAgency(data.AgencyId));\n      dispatch(fetchAgency());\n      toast.success(\"agency deleted successfully\");\n    } catch (error) {\n      toast.error(error.response.data.message);\n    }\n  };\n}","map":{"version":3,"names":["request","toast","agencyAction","fetchAgency","dispatch","data","get","setAgencies","error","response","message","getAgenciesCount","setAgencyCount","createAgency","newAgency","getState","setLoading","post","headers","Authorization","auth","admin","token","setIsAgencyCreated","success","setTimeout","clearIsAgencyCreated","console","log","clearLoading","updateAgencyPicture","newImage","AgencyId","put","updateAgency","AgencytId","setAgency","deleteAgency","delete"],"sources":["/home/chaden/Téléchargements/ttour-main/client/src/redux/apiCalls/agencyApiCall.js"],"sourcesContent":["\nimport request  from '../../utils/request'\nimport { toast } from \"react-toastify\"\nimport {  agencyAction } from '../slices/agencySlice';\n\n\n// get agencies\nexport function fetchAgency(){\n    return async(dispatch)=>{\n        try{\n\n        const {data}=await request.get(`api/agencies`);\n        dispatch(agencyAction.setAgencies(data))\n        }catch(error){\n           toast.error(error.response.data.message)\n      \n        }\n\n    }\n}\n\n//get agencies count \nexport function getAgenciesCount(){\n    return async(dispatch)=>{\n        try{\n\n        const {data}=await request.get(`api/agencies/admin/count`);\n        dispatch(agencyAction.setAgencyCount(data))\n        }catch(error){\n           toast.error(error.response.data.message)\n      \n        }\n\n    }\n}\n\n\n//create agency\nexport function createAgency(newAgency){\n    return async(dispatch , getState)=>{\n        try{\n        dispatch(agencyAction.setLoading())\n        await request.post(`api/agencies/admin` , newAgency,{\n            headers:{\n                Authorization: \"Bearer \" + getState().auth.admin.data.token,\n                \"Content-Type\":\"multipart/form-data\"\n            } \n        });\n        dispatch(agencyAction.setIsAgencyCreated())//put it ro true\n        dispatch(fetchAgency())\n        toast.success(\"agency created successfully\")\n        // after 2 seconsd we set it to false to return to the page\n        setTimeout(()=>dispatch(agencyAction.clearIsAgencyCreated()),2000)//2 second\n        }catch(error){\n            console.log(error)\n            dispatch(agencyAction.clearLoading())\n            toast.error(error.response.data.message)\n      \n        }\n\n    }\n}\n\n//update agency picture \nexport function updateAgencyPicture(newImage,AgencyId){\n    console.log(AgencyId)\n    return async(dispatch , getState)=>{\n        try{\n      \n    await request.put(`api/agencies/admin/update-image/${AgencyId}` , newImage,{\n            headers:{\n                Authorization: \"Bearer \" + getState().auth.admin.data.token,\n                \"Content-Type\":\"multipart/form-data\"\n            } \n        });\n        dispatch(fetchAgency())\n       toast.success(\"new agency image uploaded successfully\")\n        }catch(error){\n         toast.error(error.response.data.message)\n         console.log(error.response)\n        }\n\n    }\n}\n\n\n//update agency\nexport function updateAgency(newAgency,AgencytId){\n    return async(dispatch , getState)=>{\n        try{\n\n            const {data}=  await request.put(`api/agencies/admin/${AgencytId}` , newAgency,{\n                headers:{\n                    Authorization: \"Bearer \" + getState().auth.admin.data.token,\n                \n                } \n            });\n            dispatch(agencyAction.setAgency(data))\n            dispatch(fetchAgency())\n            toast.success(\"agency updated successfully\")\n            }catch(error){\n            toast.error(error.response.data.message)\n            \n            }\n\n    }\n}\n\n\n//delete agency\nexport function deleteAgency(AgencyId){\n    return async(dispatch , getState)=>{\n        try{\n      \n  const {data}=  await request.delete(`api/agencies/admin/${AgencyId}`,{\n            headers:{\n                Authorization: \"Bearer \" + getState().auth.admin.data.token,\n              \n            } \n        });\n        dispatch(agencyAction.setAgency(data.AgencyId))\n        dispatch(fetchAgency())\n        toast.success(\"agency deleted successfully\")\n        }catch(error){\n         toast.error(error.response.data.message)\n        \n        }\n\n    }\n}\n\n\n\n\n\n\n\n\n\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}